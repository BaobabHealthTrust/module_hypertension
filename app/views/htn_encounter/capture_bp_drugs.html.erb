<script type="text/javascript">
  var tt_cancel_destination = "/htn_encounter/bp_management?patient_id=<%= @patient.patient_id %>";
  function addButton() {
    var nextDrug = document.createElement("button");
    nextDrug.innerHTML = "<span>New Drug</span>";
    nextDrug.setAttribute("onclick", "newDrug()");
    nextDrug.setAttribute("id", "nextDrug")
    document.getElementById("buttons").appendChild(nextDrug);
  }
  window.setTimeout("addButton()", 200);

  function newDrug(){
    currentInput = document.getElementById("touchscreenInput" + tstCurrentPage).value;
    if (currentInput == ''){
      console.log("No Value detected")
      showMessage('You must enter a value to continue');
      return false;
    }
    gotoNextPage();
  }

function changeDefaultSettings(){
  nextButton = document.getElementById('nextButton');
  nextButton.innerHTML = '<span>Finish</span>';
  nextButton.onmousedown = function(){
    drug = document.getElementById("touchscreenInput" + tstCurrentPage).value;
    if (drug == ''){
      console.log("No Value detected")
      showMessage('You must enter a value to continue');
      return false;
    }

    document.getElementById('myDrugs').submit();
  }
}

</script>
<style type="text/css">

</style>
<script src="/javascripts/jquery-1.3.2.min.js" type="text/javascript"></script>

<form id="myDrugs" action="/htn_encounter/capture_bp_drugs" method="POST">

  <%  1.upto(10) do |i| %>
    <% if i != 1 %>
      <%= text_field_tag "bp_drugs[]", nil,
        {
        :id => "drug_#{i}",
        :optional => "true",
        :tt_onLoad => "changeDefaultSettings();",
        :helpText => "Drug Name #{i}"
      } %>
    <% else %>
      <%= text_field_tag "bp_drugs[]", nil,
        {
        :id => "drug_#{i}",
        :tt_onLoad => "changeDefaultSettings();",
        :helpText => "Drug Name #{i}"
      } %>
    <% end %>
  <% end %>
  <%= hidden_field_tag "patient_id", @patient.id %>
  <%= submit_tag "Finish" %>
</form>
