<html>
<head>
<script src="/javascripts/jquery-1.3.2.min.js" type="text/javascript"></script>
<script>

</script>

<style>
    #nextButton{
        min-width: 170px !important;
    }
    .holder{
        width: 99%;
        padding: 1.5%;
    }
    #main-table{
        width: 90%;
        margin:auto;
    }
    #main-table th{
        font-size: 20px;
        background-color: firebrick;
        color: white;
    }
    #main-table th, #main-table td{
        text-align: center;
        padding: 10px;
    }
    .td-title{
        font-size:22px;
        text-shadow: 2px 2px white;
    }
    .td-current{
        background-color: #EED5D2;
        text-shadow: 2px 2px white;
    }
    .td-remaining{
        background-color: #ffe5e5;
        text-shadow: 2px 2px white;
    }
    .td-value{
        font-size: 22px;
    }
    .butt{
        background: #E0FFFF;
        border-radius: 5px;
        padding: 7px;
        width: 110px;
        cursor: pointer;
        margin: auto;
        font-size: 24px;
        text-shadow: 2px 2px white;
        text-align: center;
    }

    .keyboard_button {
        cursor: pointer;
        font-size: 1.5em;
        min-width: 60px;
        width: 55px;
        height: 35px;
        min-height: 35px;
        margin: 2px;
        padding-top: 10px;
    }

    .button_blue{
        border:1px solid #7eb9d0; -webkit-border-radius: 3px; -moz-border-radius: 3px;border-radius: 3px;font-size:28px;font-family:arial, helvetica, sans-serif; padding: 10px 10px 10px 10px; text-decoration:none; display:inline-block;text-shadow: -1px -1px 0 rgba(0,0,0,0.3);font-weight:bold; color: #FFFFFF;
        background-color: #a7cfdf; background-image: -webkit-gradient(linear, left top, left bottom, from(#a7cfdf), to(#23538a));
        background-image: -webkit-linear-gradient(top, #a7cfdf, #23538a);
        background-image: -moz-linear-gradient(top, #a7cfdf, #23538a);
        background-image: -ms-linear-gradient(top, #a7cfdf, #23538a);
        background-image: -o-linear-gradient(top, #a7cfdf, #23538a);
        background-image: linear-gradient(to bottom, #a7cfdf, #23538a);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#a7cfdf, endColorstr=#23538a);
    }

    .button_blue:hover{
        border:1px solid #5ca6c4;
        background-color: #82bbd1; background-image: -webkit-gradient(linear, left top, left bottom, from(#82bbd1), to(#193b61));
        background-image: -webkit-linear-gradient(top, #82bbd1, #193b61);
        background-image: -moz-linear-gradient(top, #82bbd1, #193b61);
        background-image: -ms-linear-gradient(top, #82bbd1, #193b61);
        background-image: -o-linear-gradient(top, #82bbd1, #193b61);
        background-image: linear-gradient(to bottom, #82bbd1, #193b61);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#82bbd1, endColorstr=#193b61);
    }

    .button_green{
        border:1px solid #34740e;
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;
        font-size:28px;
        font-family:arial, helvetica, sans-serif;
        padding: 10px 10px 10px 10px;
        text-decoration:none;
        display:inline-block;
        text-shadow: -1px -1px 0 rgba(0,0,0,0.3);
        font-weight:bold; color: #FFFFFF;
        background-color: #4ba614;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#4ba614), to(#008c00));
        background-image: -webkit-linear-gradient(top, #4ba614, #008c00);
        background-image: -moz-linear-gradient(top, #4ba614, #008c00);
        background-image: -ms-linear-gradient(top, #4ba614, #008c00);
        background-image: -o-linear-gradient(top, #4ba614, #008c00);
        background-image: linear-gradient(to bottom, #4ba614, #008c00);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#4ba614, endColorstr=#008c00);
    }

    .button_green:hover{
        border:1px solid #224b09;
        background-color: #36780f; background-image: -webkit-gradient(linear, left top, left bottom, from(#36780f), to(#005900));
        background-image: -webkit-linear-gradient(top, #36780f, #005900);
        background-image: -moz-linear-gradient(top, #36780f, #005900);
        background-image: -ms-linear-gradient(top, #36780f, #005900);
        background-image: -o-linear-gradient(top, #36780f, #005900);
        background-image: linear-gradient(to bottom, #36780f, #005900);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#36780f, endColorstr=#005900);
    }

    .button_red{
        border:1px solid #72021c; -webkit-border-radius: 3px; -moz-border-radius: 3px;border-radius: 3px;font-size:28px;font-family:arial, helvetica, sans-serif; padding: 10px 10px 10px 10px; text-decoration:none; display:inline-block;text-shadow: -1px -1px 0 rgba(0,0,0,0.3);font-weight:bold; color: #FFFFFF;
        background-color: #a90329; background-image: -webkit-gradient(linear, left top, left bottom, from(#a90329), to(#6d0019));
        background-image: -webkit-linear-gradient(top, #a90329, #6d0019);
        background-image: -moz-linear-gradient(top, #a90329, #6d0019);
        background-image: -ms-linear-gradient(top, #a90329, #6d0019);
        background-image: -o-linear-gradient(top, #a90329, #6d0019);
        background-image: linear-gradient(to bottom, #a90329, #6d0019);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#a90329, endColorstr=#6d0019);
    }

    .button_red:hover{
        border:1px solid #450111;
        background-color: #77021d; background-image: -webkit-gradient(linear, left top, left bottom, from(#77021d), to(#3a000d));
        background-image: -webkit-linear-gradient(top, #77021d, #3a000d);
        background-image: -moz-linear-gradient(top, #77021d, #3a000d);
        background-image: -ms-linear-gradient(top, #77021d, #3a000d);
        background-image: -o-linear-gradient(top, #77021d, #3a000d);
        background-image: linear-gradient(to bottom, #77021d, #3a000d);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#77021d, endColorstr=#3a000d);
    }

    .ok, .cancel{
        min-width: 82px;
        min-height: 35px !important;
        width: 82px;
        height: 35px !important;
        padding-top: 10px;
        text-align: center;
        font-size: 27px;
        border-radius: 10px;
    }

    .ok{
        float: left;
        margin-left: 22px;
    }
    .cancel{
        float: right;
        margin-right: 18px;
        top: 0px;
    }
    .display-space{
        width: 100%;
        text-decoration: underline;
        padding-left: 3%;
    }

    #left{
        padding: 0px;
    }
    #input{
        margin-top: 10px !important;
    }
    caption{
        font-weight: bold;
        font-size: 26px;
    }
    .checked{
        background: url("/touchscreentoolkit/lib/images/ticked")
    }
    .unchecked{
        background: url("/touchscreentoolkit/lib/images/unticked")
    }

</style>
<%   @data = {"HCZ" => {"25mg" => "HCT (25mg tablet)"},
              "Amlodipine" => {"5mg" => "Amlodipine (5mg tablet) ", "10mg" => "Amlodipine (10mg tablet)"},
              "Enalapril" => {"5mg" => "Enalapril (5mg tablet)", "10mg" => "Enalapril (10mg tablet)"},
              "Atenolol" => {"50mg" => "Atenolol (50mg tablet)", "100mg" => "Atenolol (100mg tablet)"}
              }
     data_keys =  ["HCZ", "Enalapril", "Amlodipine", "Atenolol"]
%>
</head>
<body>
<div class="holder">
  <table id = "main-table">
    <caption>Prescribe BP drugs<caption>
      <tr>
        <th>&nbsp;</th>
        <% data_keys.each do |key|%>
            <th><%= key%>
              <table style="width: 100%;"><tr>
                <%
                   keys = @data[key].keys.sort.reverse
                   keys.each do |ky|
                     name = @data[key][ky].strip
                     cols = @data[key].keys.length
                %>
                    <td style="width: <%= 100/cols%>%; border: 1px dotted lightgray;border-radius: 3px;">
                      <span><%= ky%></span>
                    </td>
                <%
                   end
                %>
              </tr></table></th>
        <%end%>
        </tr>
        <tr>
          <td class = "td-current td-title"><span>Current</span></td>
          <% data_keys.each do |key|%>
              <td class="td-current td-value"> <table style="width: 100%;"><tr>
                <%
                   keys = @data[key].keys.sort.reverse
                   keys.each do |ky|
                     name = @data[key][ky].strip
                     cols = @data[key].keys.length
                %>
                    <td style="width: <%= 100/cols%>%;">
                          <span><%= @current_drugs[name].blank? ? "&nbsp" : "<img  width='45' height='35' class='tick'>&nbsp;</img>"%></span>
                    </td>
                <%
                   end
                %>
              </tr></table></td>
          <%end%>
        </tr>
        <tr>
          <td class = "td-remaining td-title"><span>New</span></td>
          <% data_keys.each do |key|%>
              <td class="td-remaining td-value">

                <table style="width: 100%;"><tr>
                  <%
                     keys = @data[key].keys.sort.reverse
                     keys.each do |ky|
                       name = @data[key][ky].strip
                       cols = @data[key].keys.length

                  %>
                          <td style="width: 50%">
                    <img class="choice" width="65" height="50" id = "<%= name%>"

                          </td>

                  <%
                     end
                  %>
                </tr></table>
              </td>
          <%end%>
        </tr>
  </table>
</div>
<div id="buttons" class="buttonsDiv">
  <button id="continueButton" class="button green navButton"
          onclick="nextDestinations()"><span>Continue</span></button>
</div>
</body>
<script>
    var checks = document.getElementsByClassName("choice")
    var ticks = document.getElementsByClassName("tick")
    var imgTick = 'data:image/png;base64,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';


    for (var i = 0; i < ticks.length; i ++){
        ticks[i].src = imgTick;
    }

    for (var k in checks){
        checks[k].src = "/touchscreentoolkit/lib/images/unticked.jpg";
        checks[k].onclick = function(){
            if (this.src.match("unticked")){
                this.src = this.src.replace("unticked", "ticked")
            }else{
                this.src = this.src.replace("ticked", "unticked")
            }
        }
    }

    function nextDestinations(){
        var result = [];
        for (var i = 0; i < checks.length; i ++){

            if (!checks[i].src.match("unticked")){
                result.push(checks[i].id)
            }
        }

            var form = document.createElement("form")
            form.action = "/regimens/new?patient_id=<%= @patient.id%>"
            document.body.appendChild(form);

            var input = document.createElement("input");
            input.setAttribute("type", "hidden");
            input.setAttribute("name", "patient_id");
            input.setAttribute("value", "<%= @patient.id%>");
            form.appendChild(input);

            for (var i = 0; i < result.length; i ++){
                var input = document.createElement("input");
                input.setAttribute("type", "hidden");
                input.setAttribute("name", "auto_rx[]");
                input.setAttribute("value", result[i]);
                form.appendChild(input)
            }

            form.submit();
    }

</script>
</html>