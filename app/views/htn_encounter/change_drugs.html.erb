<html>
<head>
<script src="/javascripts/jquery-1.3.2.min.js" type="text/javascript"></script>
<script>

</script>

<style>
    #nextButton{
        min-width: 170px !important;
    }
    .holder{
        width: 99%;
        padding: 1.5%;
    }
    #main-table{
        width: 90%;
        margin:auto;
    }
    #main-table th{
        font-size: 20px;
        background-color: firebrick;
        color: white;
    }
    #main-table th, #main-table td{
        text-align: center;
        padding: 10px;
    }
    .td-title{
        font-size:22px;
        text-shadow: 2px 2px white;
    }
    .td-current{
        background-color: #EED5D2;
        text-shadow: 2px 2px white;
    }
    .td-remaining{
        background-color: #ffe5e5;
        text-shadow: 2px 2px white;
    }
    .td-value{
        font-size: 22px;
    }
    .butt{
        background: #E0FFFF;
        border-radius: 5px;
        padding: 7px;
        width: 110px;
        cursor: pointer;
        margin: auto;
        font-size: 24px;
        text-shadow: 2px 2px white;
        text-align: center;
    }

    .keyboard_button {
        cursor: pointer;
        font-size: 1.5em;
        min-width: 60px;
        width: 55px;
        height: 35px;
        min-height: 35px;
        margin: 2px;
        padding-top: 10px;
    }

    .button_blue{
        border:1px solid #7eb9d0; -webkit-border-radius: 3px; -moz-border-radius: 3px;border-radius: 3px;font-size:28px;font-family:arial, helvetica, sans-serif; padding: 10px 10px 10px 10px; text-decoration:none; display:inline-block;text-shadow: -1px -1px 0 rgba(0,0,0,0.3);font-weight:bold; color: #FFFFFF;
        background-color: #a7cfdf; background-image: -webkit-gradient(linear, left top, left bottom, from(#a7cfdf), to(#23538a));
        background-image: -webkit-linear-gradient(top, #a7cfdf, #23538a);
        background-image: -moz-linear-gradient(top, #a7cfdf, #23538a);
        background-image: -ms-linear-gradient(top, #a7cfdf, #23538a);
        background-image: -o-linear-gradient(top, #a7cfdf, #23538a);
        background-image: linear-gradient(to bottom, #a7cfdf, #23538a);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#a7cfdf, endColorstr=#23538a);
    }

    .button_blue:hover{
        border:1px solid #5ca6c4;
        background-color: #82bbd1; background-image: -webkit-gradient(linear, left top, left bottom, from(#82bbd1), to(#193b61));
        background-image: -webkit-linear-gradient(top, #82bbd1, #193b61);
        background-image: -moz-linear-gradient(top, #82bbd1, #193b61);
        background-image: -ms-linear-gradient(top, #82bbd1, #193b61);
        background-image: -o-linear-gradient(top, #82bbd1, #193b61);
        background-image: linear-gradient(to bottom, #82bbd1, #193b61);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#82bbd1, endColorstr=#193b61);
    }

    .button_green{
        border:1px solid #34740e;
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;
        font-size:28px;
        font-family:arial, helvetica, sans-serif;
        padding: 10px 10px 10px 10px;
        text-decoration:none;
        display:inline-block;
        text-shadow: -1px -1px 0 rgba(0,0,0,0.3);
        font-weight:bold; color: #FFFFFF;
        background-color: #4ba614;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#4ba614), to(#008c00));
        background-image: -webkit-linear-gradient(top, #4ba614, #008c00);
        background-image: -moz-linear-gradient(top, #4ba614, #008c00);
        background-image: -ms-linear-gradient(top, #4ba614, #008c00);
        background-image: -o-linear-gradient(top, #4ba614, #008c00);
        background-image: linear-gradient(to bottom, #4ba614, #008c00);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#4ba614, endColorstr=#008c00);
    }

    .button_green:hover{
        border:1px solid #224b09;
        background-color: #36780f; background-image: -webkit-gradient(linear, left top, left bottom, from(#36780f), to(#005900));
        background-image: -webkit-linear-gradient(top, #36780f, #005900);
        background-image: -moz-linear-gradient(top, #36780f, #005900);
        background-image: -ms-linear-gradient(top, #36780f, #005900);
        background-image: -o-linear-gradient(top, #36780f, #005900);
        background-image: linear-gradient(to bottom, #36780f, #005900);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#36780f, endColorstr=#005900);
    }

    .button_red{
        border:1px solid #72021c; -webkit-border-radius: 3px; -moz-border-radius: 3px;border-radius: 3px;font-size:28px;font-family:arial, helvetica, sans-serif; padding: 10px 10px 10px 10px; text-decoration:none; display:inline-block;text-shadow: -1px -1px 0 rgba(0,0,0,0.3);font-weight:bold; color: #FFFFFF;
        background-color: #a90329; background-image: -webkit-gradient(linear, left top, left bottom, from(#a90329), to(#6d0019));
        background-image: -webkit-linear-gradient(top, #a90329, #6d0019);
        background-image: -moz-linear-gradient(top, #a90329, #6d0019);
        background-image: -ms-linear-gradient(top, #a90329, #6d0019);
        background-image: -o-linear-gradient(top, #a90329, #6d0019);
        background-image: linear-gradient(to bottom, #a90329, #6d0019);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#a90329, endColorstr=#6d0019);
    }

    .button_red:hover{
        border:1px solid #450111;
        background-color: #77021d; background-image: -webkit-gradient(linear, left top, left bottom, from(#77021d), to(#3a000d));
        background-image: -webkit-linear-gradient(top, #77021d, #3a000d);
        background-image: -moz-linear-gradient(top, #77021d, #3a000d);
        background-image: -ms-linear-gradient(top, #77021d, #3a000d);
        background-image: -o-linear-gradient(top, #77021d, #3a000d);
        background-image: linear-gradient(to bottom, #77021d, #3a000d);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#77021d, endColorstr=#3a000d);
    }

    .ok, .cancel{
        min-width: 82px;
        min-height: 35px !important;
        width: 82px;
        height: 35px !important;
        padding-top: 10px;
        text-align: center;
        font-size: 27px;
        border-radius: 10px;
    }

    .ok{
        float: left;
        margin-left: 22px;
    }
    .cancel{
        float: right;
        margin-right: 18px;
        top: 0px;
    }
    .display-space{
        width: 100%;
        text-decoration: underline;
        padding-left: 3%;
    }

    #left{
        padding: 0px;
    }
    #input{
        margin-top: 10px !important;
    }
    caption{
        font-weight: bold;
        font-size: 26px;
    }
    .checked{
        background: url("/touchscreentoolkit/lib/images/ticked")
    }
    .unchecked{
        background: url("/touchscreentoolkit/lib/images/unticked")
    }
</style>
<%
   @data = {"HCZ 25mg" => {"current" => true, "new" => ''},
            "Amlodipine (5mg tablet)" => {"current" => false, "new" => '54'},
            "Amlodipine (10mg tablet)" => {"current" => false, "new" => '54'},
            "Enalapril (5mg tablet)" => {"current" => true, "new" => '18'},
            "Enalapril (10mg tablet)" => {"current" => true, "new" => '18'},
            "Atenolol (50mg tablet)" => {"current" => true, "new" => '18'},
            "Atenolol (100mg tablet)" => {"current" => true, "new" => '18'}
   }
   data_keys =  @data.keys.sort
%>
</head>
<body>
<div class="holder">
  <table id = "main-table">
    <caption>Change BP drugs<caption>
      <tr>
        <th>&nbsp;</th>
        <% data_keys.each do |key|%>
            <th><%= key%></th>
        <%end%>
        <tr>
        <tr>
          <td class = "td-current td-title"><span>Current</span></td>
          <% data_keys.each do |key|%>
              <td class="td-current td-value"><span><%= @data[key]["current"] ? "X" : "&nbsp;"%></span></td>
          <%end%>
        </tr>
        <tr>
          <td class = "td-remaining td-title"><span>New</span></td>
          <% data_keys.each do |key|%>
              <td class="td-remaining td-value">
                    <img width="65" height="50" id = "<%= key%>"
              </td>
          <%end%>
        </tr>
  </table>
</div>
<div id="buttons" class="buttonsDiv">
  <button id="continueButton" class="button green navButton"
          onclick="nextDestinations()"><span>Continue current drugs</span></button>
</div>
</body>
<script>
    var checks = document.getElementsByTagName("img")

    for (var k in checks){
        checks[k].src = "/touchscreentoolkit/lib/images/unticked.jpg";
        checks[k].onclick = function(){
            if (this.src.match("unticked")){
                this.src = this.src.replace("unticked", "ticked")
            }else{
                this.src = this.src.replace("ticked", "unticked")
            }
        }
    }

    function nextDestinations(){
        var result = [];
        for (var i = 0; i < checks.length; i ++){

            if (!checks[i].src.match("unticked")){
                result.push(checks[i].id)
            }
        }
        jQuery.ajax({
            url: "/htn_encounter/auto_prescription?patient_id=<%= @patient.id%>&drugs=" + result.join("$$"),
            success: function(){
                console.log("Updated prescriptions for drugs:  " + result.join(" & "))
            }
        })
    }

</script>
</html>